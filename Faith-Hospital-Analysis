
--CREATE PATIENT DETAILS TABLE

CREATE TABLE patient_details(
pt_id INT PRIMARY KEY,
Name VARCHAR(50),
Age VARCHAR(20),
Sex VARCHAR(1),
Occupation VARCHAR(30),
Level_of_education VARCHAR(30),
Marital_status VARCHAR(30)
);
SELECT * FROM patient_details;
ALTER TABLE patient_details
ALTER COLUMN age TYPE INT USING age::INT;

ALTER TABLE patient_details
ALTER COLUMN sex TYPE VARCHAR(10);

UPDATE patient_details
SET sex = CASE
		WHEN LOWER(TRIM(sex)) = 'm' THEN 'M'
		WHEN LOWER(TRIM(sex)) = 'f' THEN 'F'
		ELSE 'Unknown'
END
		


SELECT * FROM patient_details;

--CREATE ADMISSION DETAILS TABLE
CREATE TABLE admission_details(
pt_id INT REFERENCES patient_details (pt_id),
admission_id INT PRIMARY KEY,
admission_duration INT,
doctor_id VARCHAR (20),
dama VARCHAR(10),
reason_for_dama VARCHAR(50),
dead VARCHAR (10),
cause_of_death VARCHAR(50),
ckd VARCHAR(10),
cause_ckd VARCHAR(50),
dialysis VARCHAR(10),
no_of_sessions INT,
stroke VARCHAR(10),
dm VARCHAR(10),
cancer VARCHAR(10),
type_of_cancer VARCHAR(50),
pud VARCHAR(10)
);

ALTER TABLE admission_details
ADD FOREIGN KEY (doctor_id)
REFERENCES doctors(doctor_id);

UPDATE admission_details
